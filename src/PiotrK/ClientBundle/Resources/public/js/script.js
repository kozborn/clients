// Generated by CoffeeScript 1.4.0
(function() {
  var Filter,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  jQuery(document).ready(function($) {
    var filter;
    return filter = new Filter;
  });

  Filter = (function() {

    Filter.prototype.inputs = null;

    Filter.prototype.button = null;

    Filter.prototype.container = null;

    Filter.prototype.url = null;

    Filter.prototype.paginator = null;

    Filter.currentPage = 1;

    function Filter() {
      this.search = __bind(this.search, this);

      this.setCurrentPage = __bind(this.setCurrentPage, this);
      this.inputs = $('input');
      $(".datetime").datepicker({
        dateFormat: "yy-mm-dd"
      });
      this.button = $('button#search-result');
      this.container = $('#report-container');
      this.url = "/app_dev.php/report-filter";
      this.button.click(this.search);
      this.bindPagination();
    }

    Filter.prototype.bindPagination = function() {
      return $('.paginator').find('a').bind('click', this.setCurrentPage);
    };

    Filter.prototype.setCurrentPage = function(e) {
      e.preventDefault();
      this.currentPage = $(e.target).data('page');
      return this.search();
    };

    Filter.prototype.search = function() {
      var values,
        _this = this;
      values = {};
      values.page = this.currentPage;
      this.inputs.each(function(index, item) {
        if (item.value) {
          return values[$(item).attr('name')] = item.value;
        }
      });
      console.log(values);
      return this.post = $.ajax({
        url: this.url,
        type: "POST",
        data: values
      }).done(function(response) {
        _this.container.html(response);
        return _this.bindPagination();
      }).fail(function(jqHXR, response) {
        return console.log(response);
      });
    };

    return Filter;

  })();

}).call(this);
